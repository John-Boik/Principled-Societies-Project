{% extends "layout.html" %}

{% block title %}
  <title>Results</title>
{% endblock %}


{% block page_head %}
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-35447340-1', 'auto');
    ga('send', 'pageview');
  </script>


  <script src="{{ url_for('static', filename='brython/src/brython.js') }}"></script>
  <script type="text/python" src="{{ url_for('static', filename='python/layout.py') }}"></script>
  <script src="{{ url_for('static', filename='javascript/jquery.knob.min.js') }}"></script>

  <link rel="stylesheet" href="{{ url_for('static', filename='css/ledda_results.css') }}" >

  <!--<script src="http://ariutta.github.io/svg-pan-zoom/dist/svg-pan-zoom.min.js"></script>-->
  <script src="{{ url_for('static', filename='javascript/svg-pan-zoom.min.js')  }}"></script>

  <script type="text/javascript" 
  src="{{ url_for('static', filename='javascript/highcharts.js')  }}"></script>

  <script type="text/javascript" 
  src="{{ url_for('static', filename='javascript/exporting.js')  }}"></script>

{% endblock %}


{% block body %}

<!-- ========================== Initialize ============================================== -->

<script type="text/python">
from browser import window
results = {{ results|safe }}
window.results = results
</script>

<script type="text/python"
src="{{ url_for('static', filename='python/results.py') }}"></script>




<!-- ========================== Modal ============================================== -->

<div id="modal_container" class="modal">
  <div id="modalContentContainer">
    <span id="closeModal">x</span>
    <span id="modalContent"></span>
  </div>
</div>


<!-- ========================== Group 0 ============================================== -->


<div class="container-fluid">
  <div class="row">
    <div class="col-xl-12 col-lg-12 col-med-12 col-sm-12 cols-xs-12 center">
      <h1 class="blue-sect">Fitness Overview</h1>
    </div>
  </div>
</div>


<div class="container-fluid">
  <div class="row">
    <div class="col-xl-12 col-lg-12 col-med-12 col-sm-12 cols-xs-12 p-sect result-col">

      <p>The grand fitness is <span id="output_grand_fitness" class="output_calc" >...wait...</span> T&D.</p>

      <div id="grand_fitness_table" ></div>

      <p>The fitness at a single node is calculated as abs(total inflow - total outflow), for tokens and dollars separately, then added together. The grand fitness is the sum of fitness values over all nodes. It can be evaluated as:
      </p>
      <ul>
      <li>0&ndash;10 T&D per person (0&ndash;<span id="threshold_lo_1" class="output_calc">...wait...</span> T&D): Excellent</li>
      <li>10&ndash;100 T&D per person (<span id="threshold_lo_2" class="output_calc">...wait...</span>&ndash;<span id="threshold_hi_1" class="output_calc">...wait...</span> T&D): OK</li>
      <li>&GT;100 T&D per person (&GT;<span class="output_calc" id="threshold_hi_2">...wait...</span> T&D): Poor</li>
      </ul>

      
      <p>If the grand fitness falls well into the last category, then all results except fitness might be meaningless. Aside from rounding and related issues, a fitness score near zero can be achieved in many ways.</p>

      <div id="scenario_table" ></div>


      <p>Results are presented in five groups: this overview and increasingly more detailed Groups 1 to 4. <b>Examine them in order (by clicking the "more info" downward facing triangles).</b> If they are examined out of order, some features might not work properly. The cells and nodes of some tables and graphs on this page are color coded to visually highlight their fitness values. For these, a linear gradient is used between gray, signifying zero fitness (best), and red, signifying either a fitness of 1,000 T&D or the maximum node fitness, whichever is larger.</p> 

      <div>
        <div id='summary_graph_container'></div>
        <caption>Figure 1. Compartments and flows in 20-node steady-state model. Dollar-only flows are in dotted green. Dollar and/or tokens flows are in solid blue.  Line weight signifies size of flow. Node color indicates fitness.</caption>
      </div>
      <br >  
      <div class="more-triangle" data-toggle="collapse" data-target="#overview-more">
        <div class="triangle-text">
          more info
        </div>
        <div class="blue-fill">
          <svg width="100%" viewBox="0 0 50 11">
            <polygon points="0,0 25,10 50,0"/>
          </svg>
        </div>
      </div>

      <div id="overview-more" class="collapse">
      
        <!-- ========================== Group 1 ============================================== -->
        <br>

        <div id="org_funding_table" ></div>
        <br>
          
        <div id="compartment_flow_summary_table" ></div>
        <br>

        <div id="params_table" ></div>
        <br>

        <div id="node_fitness_summary_table" ></div>
      </div>       

    </div>
  </div>
</div>

        
<!-- ========================== Group 2 ============================================== -->

<div class="container-fluid">
  <div class="row">
    <div class="col col-lg-12 col-xl-12 sect-title">
      <div class="sect-header green-sect sh-lower">
        <h1 class="green-sect center">Results: Starting Conditions and Targets</h1>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col col-lg-12 col-xl-12 p-sect">
      <p>The results in this section follow directly from the values chosen for starting conditions and targets.</p>
      <br>
      <div id="income_dist"></div>


      <br >  
      <div class="more-triangle" data-toggle="collapse" data-target="#group2-more">
        <div class="triangle-text">
          more info
        </div>
        <div class="green-fill">
          <svg width="100%" viewBox="0 0 50 11">
            <polygon points="0,0 25,10 50,0"/>
          </svg>
        </div>
      </div>

      <div id="group2-more" class="collapse">

        <div id="graph_person_counts"></div>
        <div id="graph_pct_employed_workforce"></div>
        <div id="graph_pie_employed_member_workforce"></div>
        <div id="graph_mean_family_income"></div>
        <div id="group_2_summary_table" ></div>
    </div>
  </div>
  </div>
</div>

<!-- ========================== Group 3 ============================================== -->

<div class="container-fluid">
  <div class="row">
    <div class="col col-lg-12 col-xl-12 sect-title">
      <div class="sect-header brown-sect sh-lower">
        <h1 class="brown-sect center">Results: Fixed/Flexible Variables</h1>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col col-lg-12 col-xl-12 p-sect">
      <p>Given starting conditions and targets, the results in this section follow directly from the values chosen for fixed/flexible variables.</p>
      <br>

      <div class="more-triangle" id="gr3_more">
        <div class="triangle-text">
          more info
        </div>
        <div class="brown-fill">
          <svg width="100%" viewBox="0 0 50 11">
            <polygon points="0,0 25,10 50,0"/>
          </svg>
        </div>
      </div>

      <div id="group3_more">
        
        <h2 style="clear:both;" class="brown-sect" >Summary Tables</h2> 
        <div id="group_3b_node_table" ></div>

        <h2 style="clear:both;" class="brown-sect" >Detailed graph</h2>



              <div id="detailed_graph_container">
                  <div class="col col-xl-1 col-lg-1 col-med-2 col-sm-12" id="graph_left"></div>
                  <div class="col col-xl-11 col-lg-11 col-med-11 col-xs-12" id="graph_right"></div>  
              </div>
              <br>




      </div>
    </div>
  </div>
</div>
<!-- ========================== Group 4 ============================================== -->


<div class="container-fluid">
  <div class="row">
    <div class="col col-lg-12 col-xl-12 sect-title">
      <div class="sect-header purple-sect sh-lower">
        <h1 class="purple-sect center">Results: Detailed Tables</h1>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col col-lg-12 col-xl-12 p-sect">
      <p>This section contains a large set of detailed tables containing flow information for each node. Click the "more info" triangle for "Results: Fixed/Flexible Variables" before clicking the "more info" triangle here. </p>
      <br>

      <div class="more-triangle" id="gr4_more">
        <div class="triangle-text">
          more info
        </div>
        <div class="purple-fill">
          <svg width="100%" viewBox="0 0 50 11">
            <polygon points="0,0 25,10 50,0"/>
          </svg>
        </div>
      </div>

      <div id="group4_more">
      <div id="all_tables" style="clear:both;"></div>
    </div>
    </div>
  </div>
</div>


<script>
  $(document).ready(function() {
    brython(1);
  });
</script>


{% endblock %}



